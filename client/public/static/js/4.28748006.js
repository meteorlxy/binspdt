(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{273:function(t,e,a){},274:function(t,e,a){},277:function(t,e,a){"use strict";var s=a(273);a.n(s).a},279:function(t,e,a){"use strict";var s=a(274);a.n(s).a},287:function(t,e,a){"use strict";a.r(e);a(89);var s,l,n=a(17),i=(a(138),a(271),a(38)),r=a(51),o=(a(272),{name:"APIResult",props:{data:{type:[Object],required:!0}},data:function(){return{moduleOneDetails:{},moduleTwoDetails:{}}},computed:Object(i.a)({},Object(r.c)("binary/modules",["modules"]),{overallPercentage:function(){return parseFloat((100*this.data.overall_similarity).toFixed(2))},overallColor:function(){return this.overallPercentage>=70?"#8e71c7":this.overallPercentage>=40?"#20a0ff":"#13ce66"},callDepth:function(){return this.data.params.k},matchAlgorithm:function(){return this.data.params.algorithm},moduleOne:function(){var t=this;return this.modules.find(function(e){return e.id===t.data.module_1_details.id})},moduleTwo:function(){var t=this;return this.modules.find(function(e){return e.id===t.data.module_2_details.id})},filteredMatchedFunctions:function(){var t=this.data.matched_functions.filter(function(t){return t.similarity>0}).sort(function(t,e){return e.similarity-t.similarity}).slice(0,50);return t}}),created:function(){var t=this;this.getModuleDetails(this.moduleOne.id).then(function(e){t.moduleOneDetails=Object(i.a)({},e,t.data.module_1_details)}),this.getModuleDetails(this.moduleTwo.id).then(function(e){t.moduleTwoDetails=Object(i.a)({},e,t.data.module_2_details)})},methods:Object(i.a)({},Object(r.b)("binary/modules",{getModuleDetails:"details"}),{formatModuleName:function(t){return"[".concat(t,"] ").concat(this.modules.find(function(e){return e.id===t}).name)}})}),u=(a(279),a(19)),c={name:"Results",components:{APIResult:Object(u.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("article",{staticClass:"api-result"},[a("section",{staticClass:"overall-similarity"},[a("ElProgress",{attrs:{type:"circle",percentage:t.overallPercentage,color:t.overallColor}}),t._v(" "),a("p",[t._v(t._s(t.$t("binary.analysis.api.result.overall_similarity"))+": "+t._s(t.overallPercentage+"%"))]),t._v(" "),a("hr")],1),t._v(" "),a("section",{staticClass:"analysis-params"},[a("p",[t._v(t._s(t.$t("binary.analysis.api.call_depth"))+": "+t._s(t.callDepth))]),t._v(" "),a("p",[t._v(t._s(t.$t("binary.analysis.api.match_algorithm"))+": "+t._s(t.matchAlgorithm))])]),t._v(" "),a("section",{staticClass:"modules-details"},[a("ElCollapse",[a("ElCollapseItem",[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-document"}),t._v("\n          "+t._s(t.$t("binary.results.result.module_details",{name:t.formatModuleName(t.moduleOne.id)}))+"\n        ")]),t._v(" "),a("div",[t._v(t._s(t.$t("binary.analysis.api.result.functions_with_api_count"))+": "+t._s(t.moduleOneDetails.functions_with_api_count))]),t._v(" "),a("div",[t._v(t._s(t.$t("binary.modules.table.functions_count"))+": "+t._s(t.moduleOneDetails.functions_count))]),t._v(" "),a("div",[t._v(t._s(t.$t("binary.modules.table.basic_blocks_count"))+": "+t._s(t.moduleOneDetails.basic_blocks_count))]),t._v(" "),a("div",[t._v(t._s(t.$t("binary.modules.table.instructions_count"))+": "+t._s(t.moduleOneDetails.instructions_count))])],2),t._v(" "),a("ElCollapseItem",[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-document"}),t._v("\n          "+t._s(t.$t("binary.results.result.module_details",{name:t.formatModuleName(t.moduleTwo.id)}))+"\n        ")]),t._v(" "),a("div",[t._v(t._s(t.$t("binary.analysis.api.result.functions_with_api_count"))+": "+t._s(t.moduleTwoDetails.functions_with_api_count))]),t._v(" "),a("div",[t._v(t._s(t.$t("binary.modules.table.functions_count"))+": "+t._s(t.moduleTwoDetails.functions_count))]),t._v(" "),a("div",[t._v(t._s(t.$t("binary.modules.table.basic_blocks_count"))+": "+t._s(t.moduleTwoDetails.basic_blocks_count))]),t._v(" "),a("div",[t._v(t._s(t.$t("binary.modules.table.instructions_count"))+": "+t._s(t.moduleTwoDetails.instructions_count))])],2)],1)],1),t._v(" "),a("section",{staticClass:"similar-functions-lists"},[a("ElCollapse",[a("ElCollapseItem",[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-document"}),t._v("\n          "+t._s(t.$t("binary.analysis.api.result.similar_functions"))+" (TOP 50)\n        ")]),t._v(" "),a("ElTable",{attrs:{data:t.filteredMatchedFunctions,border:"",stripe:""}},[a("ElTableColumn",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("ElForm",{staticClass:"table-details",attrs:{"label-position":"left",inline:""}},[a("ElFormItem",{staticClass:"long label-long",attrs:{label:t.$t("binary.analysis.api.result.function_api",{module:t.moduleOne.id})}},[a("span",[t._v(t._s(e.row.module_1_function_api.toString()))])]),t._v(" "),a("hr"),t._v(" "),a("ElFormItem",{staticClass:"long label-long",attrs:{label:t.$t("binary.analysis.api.result.function_api",{module:t.moduleTwo.id})}},[a("span",[t._v(t._s(e.row.module_2_function_api.toString()))])])],1)]}}])}),t._v(" "),a("ElTableColumn",{attrs:{prop:"module_1_function_address",label:t.$t("binary.results.result.module_function_address",{name:t.moduleOne.id})}}),t._v(" "),a("ElTableColumn",{attrs:{prop:"module_2_function_address",label:t.$t("binary.results.result.module_function_address",{name:t.moduleTwo.id})}}),t._v(" "),a("ElTableColumn",{attrs:{prop:"similarity",label:t.$t("binary.results.result.similarity"),sortable:""}})],1)],2)],1)],1)])},[],!1,null,null,null).exports},data:function(){return{showResult:!1,currentResult:{},currentResultDetails:{}}},computed:Object(i.a)({},Object(r.c)("binary/modules",["modules"]),Object(r.c)("binary/results",["results","count","numPages","page","perPage","isLoading","isLoadingDetails"]),{currentResultComponent:function(){var t=this;switch(this.currentResult.type){case"api":return"APIResult";default:return{render:function(e){return e("span",null,t.$t("status.error"))}}}}}),created:function(){this.get({page:this.page,perPage:this.perPage})},methods:Object(i.a)({},Object(r.b)("binary/results",["get","details"]),{formatModuleName:function(t){return"[".concat(t,"] ").concat(this.modules.find(function(e){return e.id===t}).name)},handleDetails:(l=Object(n.a)(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.currentResult=e,t.next=3,this.details(e.id);case 3:this.currentResultDetails=t.sent,this.showResult=!0;case 5:case"end":return t.stop()}},t,this)})),function(t){return l.apply(this,arguments)}),handleDelete:(s=Object(n.a)(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t,this)})),function(t){return s.apply(this,arguments)}),handleResultClose:function(){var t=this;this.$confirm(this.$t("binary.results.messages.close_confirm")).then(function(){t.showResult=!1,t.currentResult={},t.currentResultDetails={}}).catch(this.$noop)},handlePageChange:function(t){this.get({page:t,perPage:this.perPage})},handlePerPageChange:function(t){this.get({page:1,perPage:t})}})},d=(a(277),Object(u.a)(c,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("PageTitle",[t._v(t._s(t.$t("binary.results.title")))]),t._v(" "),a("div",{staticClass:"table-tools"},[a("ElButton",{attrs:{size:"small",icon:"el-icon-refresh",round:!0,loading:t.isLoading,title:t.$t("buttons.refresh")},on:{click:t.get}},[t._v("\n      "+t._s(t.$t("buttons.refresh"))+"\n    ")])],1),t._v(" "),a("ElTable",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],attrs:{data:t.results,border:"",stripe:""}},[a("ElTableColumn",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("ElForm",{staticClass:"table-details",attrs:{"label-position":"left",inline:""}},[a("ElFormItem",{attrs:{label:t.$t("binary.results.table.id")}},[a("span",[t._v(t._s(e.row.id))])]),t._v(" "),a("ElFormItem",{attrs:{label:t.$t("binary.results.table.type")}},[a("span",[t._v(t._s(e.row.type))])]),t._v(" "),a("ElFormItem",{attrs:{label:t.$t("binary.results.table.module_1")}},[a("span",[t._v(t._s(t.formatModuleName(e.row.module_1_id)))])]),t._v(" "),a("ElFormItem",{attrs:{label:t.$t("binary.results.table.module_2")}},[a("span",[t._v(t._s(t.formatModuleName(e.row.module_2_id)))])]),t._v(" "),a("ElFormItem",{attrs:{label:t.$t("binary.results.table.created_at")}},[a("span",[t._v(t._s(t.$helpers.formatDateTime(e.row.created_at)))])]),t._v(" "),a("ElFormItem",{attrs:{label:t.$t("binary.results.table.finished_at")}},[a("span",[t._v(t._s(t.$helpers.formatDateTime(e.row.finished_at)))])])],1)]}}])}),t._v(" "),a("ElTableColumn",{attrs:{prop:"id",label:t.$t("binary.results.table.id"),sortable:"",width:"70"}}),t._v(" "),a("ElTableColumn",{attrs:{prop:"finished_at",label:t.$t("binary.results.table.status"),sortable:"",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.finished_at?a("ElTag",{staticClass:"status",attrs:{type:"success"}},[a("i",{staticClass:"el-icon-check"}),t._v(" "),a("span",[t._v(t._s(t.$t("binary.results.status.done")))])]):a("ElTag",{staticClass:"status",attrs:{type:"warning"}},[a("i",{staticClass:"el-icon-loading"}),t._v(" "),a("span",[t._v(t._s(t.$t("binary.results.status.pending")))])])]}}])}),t._v(" "),a("ElTableColumn",{attrs:{prop:"created_at",label:t.$t("binary.results.table.created_at"),formatter:function(e){return t.$helpers.formatDateTime(e.created_at)},sortable:"",width:"170"}}),t._v(" "),a("ElTableColumn",{attrs:{prop:"type",label:t.$t("binary.results.table.type"),sortable:"",width:"130"}}),t._v(" "),a("ElTableColumn",{attrs:{prop:"module_1_id",label:t.$t("binary.results.table.module_1"),formatter:function(e){return t.formatModuleName(e.module_1_id)},sortable:""}}),t._v(" "),a("ElTableColumn",{attrs:{prop:"module_2_id",label:t.$t("binary.results.table.module_2"),formatter:function(e){return t.formatModuleName(e.module_2_id)},sortable:""}}),t._v(" "),a("ElTableColumn",{attrs:{label:t.$t("binary.results.table.operation"),fixed:"right",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("ElButton",{attrs:{size:"mini",type:"primary",icon:"el-icon-document",circle:"",title:t.$t("buttons.details"),loading:t.isLoadingDetails===e.row.id,disabled:!e.row.finished_at||!1!==t.isLoadingDetails&&t.isLoadingDetails!==e.row.id},on:{click:function(a){t.handleDetails(e.row)}}}),t._v(" "),a("ElButton",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:"",title:t.$t("buttons.remove"),disabled:!e.row.finished_at||t.isLoadingDetails&&!0},on:{click:function(a){t.handleDelete(e.row)}}})]}}])})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.numPages>1,expression:"numPages > 1"}],staticClass:"text-center pagination"},[a("ElPagination",{attrs:{layout:" total, sizes, prev, pager, next, jumper",total:t.numPages,"page-size":t.perPage,"page-sizes":[20,60,100]},on:{"current-change":t.handlePageChange,"size-change":t.handlePerPageChange}})],1),t._v(" "),a("ElDialog",{staticClass:"analysis-result",attrs:{width:"90%",title:t.$t("binary.results.result.title"),visible:t.showResult,"before-close":t.handleResultClose}},[a(t.currentResultComponent,{tag:"component",attrs:{data:t.currentResultDetails}}),t._v(" "),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("ElButton",{on:{click:t.handleResultClose}},[t._v(t._s(t.$t("binary.results.result.close")))])],1)],1)],1)},[],!1,null,"a2672e04",null));e.default=d.exports}}]);